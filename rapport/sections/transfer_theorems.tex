\documentclass[../main.tex]{subfiles}

\begin{document}

\section{Transfer theorems}

All the following results come, directly or not, from \cite{Flajolet1990}.

\begin{thm}{Main transfer theorem}
	Let $f = \sum f_n z^n$ be analytic in some open disk around the origin except for a single dominant singularity $\zeta$ and points in the ray	$R_\zeta = \{t \zeta : t \geq 1 \}$.
	
	If $f$ has a convergent expansion of the form \eqref{general_structure_form} in a disk centred at $\zeta$ minus $R_\zeta$ and $f(z) \sim C {\left( 1 - \frac{z}{\zeta} \right)}^\alpha {\left(\log \left( 1 - \frac{z}{\zeta} \right)\right)}^m$ with $\alpha \not\in \mathbb{N}$,	
	then
	
	$$f_n \sim C {\zeta}^{-n} \frac{n^{-\alpha - 1}}{\Gamma(-\alpha)} {(\log n)}^m$$
\end{thm}

%\begin{thm}{}
%	Let $\alpha \neq 0$. Then
%	
%	\begin{equation}\label{basic_scale_transfer}
%		[z^n] {(1 - z)}^\alpha \sim \frac{n^{-\alpha - 1}}{\Gamma(-\alpha)} \left( 1 + \psum{k \geq 1} \frac{e_k^{(\alpha)}}{n^k} \right)
%	\end{equation}
%	
%	where
%	
%	\begin{equation*}
%		e_k^\alpha = 
%	\end{equation*}
%\end{thm}


\begin{thm}{Other cases}
	\begin{itemize}{}{}
		~
		
		\item If $\alpha \in \mathbb{N}$ and $k = 0$, then $[z^n]{\left(1 - \frac{z}{\zeta}\right)}^\alpha = 0$ for $n > k$
		because~${\left(1 - \frac{z}{\zeta}\right)}^\alpha$ is a polynomial. So that case can be completely ruled out in estimating asymptotic expansions.
		
		%\item If $\alpha > 0$ and $k > 0$
	\end{itemize}
	
%	\tcblower
%	
%	Let $f_{a, b} : z \mapsto {(z - \zeta)}^a {(\log (z - \zeta))}^b$.
%	
%	Then by Leibniz rule (\ref{Leibniz_rule}),
%	\[
%	f_{a, b}^{(n)} = \psum{i = 0}^n f_{a, 0}^{(i)} f_{0, b}^{(n - i)}
%	\]
%	
%	For all $i > a$, we have $f_{a, 0}^{(i)} = 0$.
%	
\end{thm}


\subsection{Basic scale transfer}

We quote from \cite{Flajolet2009}

\begin{thm}{Basic scale transfer}
	Let $\alpha$ be an arbitrary complex number in
	$\mathbb{C} \setminus \mathbb{Z}_{\leq 0}$.
	The coefficient of $z^n$ in
	\[
	f(z) = {(1 - z)}^{-\alpha}
	\]
	admits for large $n$ a complete asymptotic expansion in descending powers of $n$,
	\[
	[z^n]f(z) \sim \frac{n^{\alpha - 1}}{\Gamma(\alpha)}
	\left(1 + \psum{k = 1}^{\infty} \frac{e_k}{n^k} \right)
	\]
	where $e_k$ is a polynomial in $\alpha$ of degree $2k$.In particular,
	\[
	[z^n]f(z) \sim \frac{n^{\alpha - 1}}{\Gamma(\alpha)}
	\left(1 + \frac{\alpha (\alpha - 1)}{2n}
	+ \frac{\alpha (\alpha - 1)(\alpha - 2)(3\alpha - 1)}{24n^2} + O\left( \frac{1}{n^3} \right) \right)
	\]
\end{thm}


\begin{remark}
	If $\alpha \in \mathbb{Z}_{\leq 0}$, then ${(1 - z)}^{-\alpha}$ is a polynomial, so $[z^n]f(z) = 0$ for sufficiently large $n$.
\end{remark}

\subsection{Complete scale}

\begin{thm}{}
	Let $\alpha \in \mathbb{C} \setminus \mathbb{Z}_{\leq 0}$ and $\beta \in \mathbb{N}$.
	
	Let
	\[
	f : z \mapsto {(1 - z)}^{-\alpha} {\left( \log \frac{1}{1 - z} \right)}^\beta
	\]
	
	then for large $n$ one has
\end{thm}

\begin{proof}
	By Cauchy's coefficients formula (\ref{thm_cauchy_coefficients}) in 0:
	\[
	f_n = \frac{1}{2i\pi} \int_{\mathcal{C} \left(0, \frac{1}{2}\right)} \frac{f(z)}{z^{n+1}} dz
	\]
	
	We deform $\mathcal{C}$ by increasing diameter to $r > 1$, only with a notch coming back to the left of the complex 1.
	
	\cfigure[8cm]{images/transfer_contour.pdf}{$\mathcal{C}$}
	
	\paragraph{Outer circle}
	One has
	\begin{align*}
		\left| \frac{1}{2i\pi} \int_{\mathcal{C}(0, r)} \frac{f(z)}{z^{n+1}} dz \right| \leq
		\frac{1}{2 \pi r^{n + 1}} {(r + 1)}^{-\alpha} {\log (r + 1)}^\beta
	\end{align*}
	
	Therefore, letting $r$ go to infinity, one has
	\[
	f_n = \frac{1}{2i\pi} \int_{\mathcal{H}_n} \frac{f(z)}{z^{n+1}} dz
	\]
	where $\mathcal{H}_n := \mathcal{H}^-(n) \cup \mathcal{H}^+(n) \cup \mathcal{H}^\circ(n)$ with
	\begin{equation*}
		\begin{cases}
		\mathcal{H}^-(n) = \{z \mid z = x - \frac{i}{n}, x \in \mathbb{R} \}\\
		\mathcal{H}^+(n) = \{z \mid z = x + \frac{i}{n}, x \in \mathbb{R} \}\\
		\mathcal{H}^\circ(n) = \{z \mid z = 1 - \frac{e^{i \phi}}{n}, \phi \in [ - \frac{\pi}{2}, \frac{\pi}{2} ] \}
		\end{cases}
	\end{equation*}
	
	\paragraph{Change of variable}	
	Now introduce the change of variable $z \mapsto 1 + \frac{t}{n}$.
	Then
	\begin{align*}
	\frac{f(z)}{z^{n+1}} dz
	&= {(-t)}^{-\alpha} n^\alpha {\left( \log \left( - \frac{n}{t} \right) \right) }^\beta {\left( 1 + \frac{t}{n} \right)}^{-n-1} \frac{dt}{n}\\
	&= {(-t)}^{-\alpha} n^{\alpha-1} {(\log n)}^\beta {\left( 1 - \frac{\log (-t)}{\log n} \right)}^\beta  {\left( 1 + \frac{t}{n} \right)}^{-n-1} dt
%	&= {(-t)}^{-\alpha} n^{\alpha-1} {(\log n)}^\beta
%	{\left( \psum{i = 0}^\beta {\beta \choose i} {\left( - \frac{\log (-t)}{\log n} \right)}^i \right)}
%	{\left( 1 + \frac{t}{n} \right)}^{-n-1} dt
	\end{align*}
	so
	\begin{equation*}
		f_n = \frac{1}{2i\pi} n^{\alpha - 1} {(\log n)}^\beta
		  \int_{\mathcal{H}} {(-t)}^{-\alpha} {\left( 1 - \frac{\log (-t)}{\log n} \right)}^\beta  {\left( 1 + \frac{t}{n} \right)}^{-n-1} dt
	\end{equation*}
	where $\mathcal{H}$ is as follows
	\cfigure[4cm]{images/transfer_contour_normalized.pdf}{$\mathcal{H}$}

	\paragraph{Away from the origin}
	Let $\hat{\mathcal{H}} := \{t \in \mathcal{H} \mid Re(t) \geq {(\log n)}^2 \}$.
	
	\subparagraph{Study of $\left(1 + \frac{t}{n} \right)^{n+1}$}
	Let us first recall the following inequality, from basic real analysis
	\begin{remark}
		For any $y \in \mathbb{R}^+$, one has $\log (1 + y) \geq y - \frac{y^2}{2}$.
	\end{remark}
	
	Let $x \in \mathbb{R}^+$. Then
	\begin{align*}
	{\left(1 + \frac{x}{n} \right)}^{-n}
	&= e^{-n \log \left( 1 + \frac{x}{n} \right)}\\
	&\leq e^{-x} \cdot e^{\frac{x^2}{2n}}
	\end{align*}
	
	Thus, for $Re(t) \geq {\left(\log n \right)}^2$, one has
	\begin{align*}
		{\left|1 + \frac{t}{n}\right|}^{-n-1} &\leq {\left|1 + \frac{t}{n}\right|}^{-n}\\
				&\leq {\left(1 + \frac{Re(t)}{n} \right)}^{-n}\\
				&\leq {\left(1 + \frac{{\left(\log n \right)}^2}{n}\right)}^{-n}\\
				&\leq e^{-{(\log n)}^2} \cdot e^{-\frac{{(\log n)}^4}{2n}}
	\end{align*}
	
	***
	
	
%	Since $\hat{\mathcal{H}}$ can be decomposed as the union of $\hat{\mathcal{H}}^+ := \{ u + i \mid u \geq {(\log n)}^2 \}$ and $\hat{\mathcal{H}}^- := \{ u - i \mid u \geq {(\log n)}^2 \}$, we have
%	
%	\begin{align*}
%	\int_{\hat{\mathcal{H}}} \left| {(-t)}^{-\alpha} {\left( 1 - \frac{\log (-t)}{\log n} \right)}^\beta \right| dt
%	= \int_{ \{ u \geq {(\log n)}^2 \} }& \Bigg( \left| {(-u-i)}^{-\alpha} {\left( 1 - \frac{\log (-u-i)}{\log n} \right)}^\beta \right| \Bigg.\\
%				&+ \Bigg. \left| {(-u+i)}^{-\alpha} {\left( 1 - \frac{\log (-u+i)}{\log n} \right)}^\beta \right| \Bigg) dt
%	\end{align*}
	
	\begin{align*}
	\left| \int_{\hat{\mathcal{H}}} {(-t)}^{-\alpha} {\left( 1 - \frac{\log (-t)}{\log n} \right)}^\beta  {\left( 1 + \frac{t}{n} \right)}^{-n-1} dt \right|
	&\leq e^{-{(\log n)}^2} \cdot e^{-\frac{{(\log n)}^4}{2n}} \int_{\hat{\mathcal{H}}} \left| {(-t)}^{-\alpha} {\left( 1 - \frac{\log (-t)}{\log n} \right)}^\beta \right| dt\\
	&\leq
	\end{align*}
	
%	\begin{lemma}{}
%		Let $z$ and $w$ complex numbers, with $z \not\in \mathbb{R}^-$.
%		Then $$\left|z^w\right| \leq {|z|}^{|w|}$$
%		
%		\tcblower
%		
%		\begin{align*}
%		\left|z^w\right| &= \left| e^{w \log z} \right|\\
%						 &= e^{Re(w \log z)}\\
%						 &\leq e^{|w \log z|}\\
%						 &\\
%						 &\leq {|z|}^{|w|}
%		\end{align*}
%	\end{lemma}
\end{proof}

\end{document}