\documentclass[../main.tex]{subfiles}

\begin{document}

\chapter{Singularity analysis and transfer theorems}

In the previous sections, we have seen that a holonomic function $f$ admits, in the neighbourhood of any singularity, an asymptotic expansion of the form \eqref{general_structure_form}.

In this section, we show how to compute an asymptotic expansion of $f_n$. If $f(z) = g_1(z) + \dots + g_p(z) + 0(g_{p+1}(z))$ in the neighbourhood of $\zeta$, then singularity analysis determines the contribution of $g_i$ to the asymptotic expansion of $f_n$, and the transfer theorem allows to deduce a valid asymptotic expansion.

\section{Singularity analysis}

\begin{thm}{Polynomial case}
	If $\alpha \in \mathbb{N}$, then $[z^n]{\left(1 - \frac{z}{\zeta}\right)}^\alpha = 0$ for $n > k$
	because~${\left(1 - \frac{z}{\zeta}\right)}^\alpha$ is a polynomial. So that case can be completely ruled out in estimating asymptotic expansions.
\end{thm}


\subsection*{Basic scale transfer}

We quote from \cite{Flajolet2009}

\begin{thm}{Basic scale transfer}
	Let $\alpha$ be an arbitrary complex number in
	$\mathbb{C} \setminus \mathbb{Z}_{\leq 0}$.
	The coefficient of $z^n$ in
	\[
	f(z) = {(1 - z)}^{-\alpha}
	\]
	admits for large $n$ a complete asymptotic expansion in descending powers of $n$,
	\[
	[z^n]f(z) \sim \frac{n^{\alpha - 1}}{\Gamma(\alpha)}
	\left(1 + \psum{k = 1}^{\infty} \frac{e_k^{(\alpha)}}{n^k} \right)
	\]
	where $e_k^{(\alpha)}$ is a polynomial in $\alpha$ of degree $2k$.
%	In particular,
%	\[
%	[z^n]f(z) \sim \frac{n^{\alpha - 1}}{\Gamma(\alpha)}
%	\left(1 + \frac{\alpha (\alpha - 1)}{2n}
%	+ \frac{\alpha (\alpha - 1)(\alpha - 2)(3\alpha - 1)}{24n^2} + O\left( \frac{1}{n^3} \right) \right)
%	\]
	More precisely,
	\[
	e_k^{(\alpha)} = \psum{i = k}^{2k} {(-1)}^i \lambda_{k, i} (\alpha + 1) (\alpha + 2) \dots (\alpha + i)
	\]
	with $\psum{k, i \geq 0} \lambda_{k, i} v^k t^i = e^t {(1 + vt)}^{-1 - 1/v}$.
\end{thm}

%Let $\mathcal{H}$ denote the contour
%\cfigure[4cm]{images/transfer_contour_normalized.pdf}{$\mathcal{H}$}
%
%\begin{lemma}{}\label{lemma_int_a_entier}
%	Let $n \in \mathbb{N}$.
%	Then $$\int_H {(-t)}^n e^{-t} dt = 0$$
%	
%	\tcblower
%	
%	The map $t \mapsto {(-t)}^n e^{-t}$ is an entire function. Thus, with $H_{\leq r} := \{z \in H \mid \Re(z) \leq r\}$ for $r > 0$, we have
%	$$
%	\int_{H_{\leq r}} {(-t)}^n e^{-t}dt = -\int_{\{r + iu ~\mid~ u \in [-1, 1]\}} {(-t)}^n e^{-t} dt
%	$$
%	and the modulus of the latter integral tends to 0 as $r$ tends to infinity.
%\end{lemma}
%
%\begin{lemma}{}\label{lemma_int_a_complexe}
%	Let $a \not\in \mathbb{N}$.
%	Then $$\int_H {(-t)}^a e^{-t} dt = \frac{2i\pi}{\Gamma(-a)}$$
%\end{lemma}
%
%\begin{remark}
%	Lemma \ref{lemma_int_a_entier} can be viewed as a limit case of lemma \ref{lemma_int_a_complexe}, since $\Gamma$ has poles at negative integers.
%\end{remark}
%
%\begin{thm}{}
%	Let $a \in \mathbb{R} \setminus \mathbb{Z}_{\leq 0}$ and $b \in \mathbb{N}^*$.
%	
%	Let
%	\[
%	f : z \mapsto {(1 - z)}^{-a} {\left( \frac{1}{z} \log \frac{1}{1 - z} \right)}^b
%	\]
%	then for large $n$ one has
%	$$f_n = [z^n] f(z) \sim
%	\frac{n^{-a -1}}{\Gamma(-a)}
%	{(\log n)}^b
%	\left(1 + \psum{k \geq 1} \frac{e_k^{(a, b)}}{\log^k n} \right)$$
%	with
%	$$
%	e_k^{(a, b)} = {(-1)}^k {b \choose k} \Gamma(-a) \frac{d^k}{ds^k} \left[ \frac{1}{\Gamma(-s)} \right] (a)
%	$$
%\end{thm}
%
%\begin{proof}
%	Note that $f$ is analytic in the plane slit $[1, +\infty]$.
%
%	By Cauchy's coefficients formula (\ref{thm_cauchy_coefficients}) in 0:
%	\[
%	f_n = \frac{1}{2i\pi} \int_{C} \frac{f(z)}{z^{n+1}} dz
%	\]
%	
%	Where $C$ is a deformed circle with a notch coming back to the left of the complex 1.
%	
%	\cfigure[8cm]{images/transfer_contour.pdf}{$C$}
%	
%	More precisely, $C := \gamma_1 \cup \gamma_2 \cup \gamma_3 \cup \gamma_4$, where
%	\begin{align*}
%		\gamma_1 := &\left\{ {{z = 1 - \frac{u}{n}} ;~ {u = e^{i \theta}, \theta \in \left[- \frac{\pi}{2}, \frac{\pi}{2} \right]}} \right\}\\
%		\gamma_2, \gamma_4 := &\left\{ z = 1 + \frac{u \pm i}{n} ;~ u \in [0, n] \right\}\\
%		\gamma_3 := &\left\{ z ;~ |z| = {\left(4 + \frac{1}{n^2}\right)}^{1/2}, \Re(z) \leq 2 \right\}
%	\end{align*}
%	
%	\paragraph{Outer circle}
%	Let $r = {\left(4 + \frac{1}{n^2}\right)}^{1/2}$. Then 
%	\begin{align*}
%		\left| \frac{1}{2i\pi} \int_{\gamma_3} \frac{f(z)}{z^{n+1}} dz \right|
%		&\leq \frac{1}{2\pi} \int_{\gamma_3} \left| \frac{f(z)}{z^{n+1}} \right| dz \\
%		&\leq \frac{1}{2i\pi} \int_{\mathcal{C}(0, r)} \left| \frac{f(z)}{z^{n+1}} \right| dz\\
%		& \leq \frac{1}{2 \pi r^{n + 1}} {(r + 1)}^{-a} {\log (r + 1)}^b
%	\end{align*}
%	which is a $O(r^{-n})$, so the main part of our expansion is expected to come from the integral over $\gamma_1 \cup \gamma_2 \cup \gamma_4$.
%	
%%	where $\mathcal{H}_n := \mathcal{H}^-(n) \cup \mathcal{H}^+(n) \cup \mathcal{H}^\circ(n)$ with
%%	\begin{equation*}
%%		\begin{cases}
%%		\mathcal{H}^-(n) = \{z \mid z = x - \frac{i}{n}, x \in \mathbb{R} \}\\
%%		\mathcal{H}^+(n) = \{z \mid z = x + \frac{i}{n}, x \in \mathbb{R} \}\\
%%		\mathcal{H}^\circ(n) = \{z \mid z = 1 - \frac{e^{i \phi}}{n}, \phi \in [ - \frac{\pi}{2}, \frac{\pi}{2} ] \}
%%		\end{cases}
%%	\end{equation*}
%	
%	\paragraph{Change of variable}	
%	Now introduce the change of variable $z \mapsto 1 + \frac{t}{n}$.
%	Then (using corollary \ref{cor_log_identities} and the fact that $b$ is a positive integer)
%	\begin{align*}
%	\frac{f(z)}{z^{n+1}} dz
%	&= {(-t)}^{-a} n^a {\left( \log \left( - \frac{n}{t} \right) \right) }^b {\left( 1 + \frac{t}{n} \right)}^{-n-1} \frac{dt}{n}\\
%	&= {(-t)}^{-a} n^{a-1} {(\log n)}^b {\left( 1 - \frac{\log (-t)}{\log n} \right)}^b  {\left( 1 + \frac{t}{n} \right)}^{-n-1} dt\\
%	&= {(-t)}^{-a} n^{a-1} {(\log n)}^b
%	{\left( \psum{i = 0}^b {b \choose i} {\left( - \frac{\log (-t)}{\log n} \right)}^i \right)}
%	{\left( 1 + \frac{t}{n} \right)}^{-n-1} dt
%	\end{align*}
%	so
%	\begin{equation*}
%		f_n = \frac{1}{2i\pi} n^{a - 1} {(\log n)}^b \psum{i=0}^b  {b \choose i}
%		  \int_{\mathcal{H}_n} {(-t)}^{-a} {\left( - \frac{\log (-t)}{\log n} \right)}^i {\left( 1 + \frac{t}{n} \right)}^{-n-1} dt
%	\end{equation*}
%	where $\mathcal{H}_n := \{z \in \mathcal{H} \mid \Re(z) \leq n \}$.
%
%	\paragraph{Away from the origin}
%	Let $\hat{\mathcal{H}} := \{t \in \mathcal{H} \mid \Re(t) \geq {(\log n)}^2 \}$.
%	
%	\subparagraph{Study of $\left(1 + \frac{t}{n} \right)^{n+1}$}
%	Let us first recall the following inequality, from basic real analysis
%	\begin{remark}
%		For any $y \in \mathbb{R}^+$, one has $\log (1 + y) \geq y - \frac{y^2}{2}$.
%	\end{remark}
%	
%	Let $x \in \mathbb{R}^+$. Then
%	\begin{align*}
%	{\left(1 + \frac{x}{n} \right)}^{-n}
%	&= e^{-n \log \left( 1 + \frac{x}{n} \right)}\\
%	&\leq e^{-x} \cdot e^{\frac{x^2}{2n}}
%	\end{align*}
%	
%	Thus, for $\Re(t) \geq {\left(\log n \right)}^2$, one has
%	\begin{align*}
%		{\left|1 + \frac{t}{n}\right|}^{-n-1} &\leq {\left|1 + \frac{t}{n}\right|}^{-n}\\
%				&\leq {\left(1 + \frac{\Re(t)}{n} \right)}^{-n}\\
%				&\leq {\left(1 + \frac{{\left(\log n \right)}^2}{n}\right)}^{-n}\\
%				&\leq e^{-{(\log n)}^2} \cdot e^{\frac{{(\log n)}^4}{2n}}
%	\end{align*}
%	
%	***
%	
%	
%%	Since $\hat{\mathcal{H}}$ can be decomposed as the union of $\hat{\mathcal{H}}^+ := \{ u + i \mid u \geq {(\log n)}^2 \}$ and $\hat{\mathcal{H}}^- := \{ u - i \mid u \geq {(\log n)}^2 \}$, we have
%%	
%%	\begin{align*}
%%	\int_{\hat{\mathcal{H}}} \left| {(-t)}^{-\alpha} {\left( 1 - \frac{\log (-t)}{\log n} \right)}^\beta \right| dt
%%	= \int_{ \{ u \geq {(\log n)}^2 \} }& \Bigg( \left| {(-u-i)}^{-\alpha} {\left( 1 - \frac{\log (-u-i)}{\log n} \right)}^\beta \right| \Bigg.\\
%%				&+ \Bigg. \left| {(-u+i)}^{-\alpha} {\left( 1 - \frac{\log (-u+i)}{\log n} \right)}^\beta \right| \Bigg) dt
%%	\end{align*}
%
%	On $\hat{\mathcal{H}}^+$, we have
%	\begin{align*}
%		arg\left(-\frac{n}{t}\right) &= arg(-n) - arg(t)\\
%									&\in [\pi - Arg(\log^2 (n) + i), \pi]
%	\end{align*}
%	
%	So
%	\begin{align*}
%		\left| {\log\left(\frac{n}{t}\right)}^\beta \right| \leq
%		{\left(\log\left(\left|\frac{n}{t}\right|\right) + \left|arg\left(\frac{n}{t}\right)\right|\right)}^\beta
%	\end{align*}
%	
%	\begin{align*}
%	\left| \int_{\hat{\mathcal{H}}} {(-t)}^{-\alpha} {\left( 1 - \frac{\log (-t)}{\log n} \right)}^\beta  {\left( 1 + \frac{t}{n} \right)}^{-n-1} dt \right|
%	&\leq e^{-{(\log n)}^2} \cdot e^{\frac{{(\log n)}^4}{2n}} \int_{\hat{\mathcal{H}}} \left| {(-t)}^{-\alpha} {\left( 1 - \frac{\log (-t)}{\log n} \right)}^\beta \right| dt\\
%	&\leq
%	\end{align*}
%	
%%	\begin{lemma}{}
%%		Let $z$ and $w$ complex numbers, with $z \not\in \mathbb{R}^-$.
%%		Then $$\left|z^w\right| \leq {|z|}^{|w|}$$
%%		
%%		\tcblower
%%		
%%		\begin{align*}
%%		\left|z^w\right| &= \left| e^{w \log z} \right|\\
%%						 &= e^{\Re(w \log z)}\\
%%						 &\leq e^{|w \log z|}\\
%%						 &\\
%%						 &\leq {|z|}^{|w|}
%%		\end{align*}
%%	\end{lemma}
%\end{proof}


\subsection*{Complete scale}

In this section, we closely follow \cite{Jungen1931}.

\begin{lemma}{}
	Let $k \in \mathbb{N}^*$ and $f = \sum f_n z^n$ with
	$$
	f(z) = {(1 - z)}^{-k}
	$$
	Then for all $n$, we have
	$$
	f_n = \frac{n^{k - 1}}{\Gamma(k)} \left[1 + \frac{k(k-1)}{2n} + \dots + \frac{\Gamma(k)}{n^{k-1}}\right]
	$$
	
	\tcblower
	
	Start with
	$${(1 - z)}^{-1} = \sum z^n$$
	Now differentiating that relation $k - 1$ times, we get
	$$
	(k-1)! {(1-z)}^{-k} = \sum \frac{(n + k -1)!}{n!}z^n
	$$
	Therefore $f_n = \frac{1}{(k-1)!} (n+1)(n+2)\dots(n+k-1)$, and the result follows by developing the product and grouping by powers of $n$.
\end{lemma}

The following three results are quoted from \cite{Jungen1931} without proof. For a reference, one may consult \cite{knopp1928}. They shall be useful in the proof of theorem \ref{thm_expansion_log} to assert the domains of validity of the computed expansions.

\begin{lemma}{}\label{jungen_lemma_1}
	Let $\phi(z)$ admit an asymptotic expansion
	\begin{equation}\label{asymptotic_expansion_form}
	\varphi(z) \sim c_0 + \frac{c_1}{z} + \frac{c_2}{z^2} + \dots
	\end{equation}
	as $z$ goes to infinity following a half line $d$.
	
	Then for every constant $z_0$, we also have, asymptotically along $d$,
	\[
	\varphi(z_0 + z) \sim c_0 + \frac{c_1}{z} + \frac{-c_1 z_0 + c_2}{z^2} + \dots
	\]
\end{lemma}

\begin{lemma}{}\label{jungen_lemma_2}
	Let $\varphi(z)$ be analytic in the form \eqref{asymptotic_expansion_form} on a half band
	\begin{equation}\label{band_form}
	\begin{cases}
	\Re(z) > a\\
	\Im(z) \in ]-b, b[
	\end{cases}
	\end{equation}
	for $a$ and $b$ arbitrary positive real numbers.
	
	Then $e^{\varphi(z)}$ can also be expanded, over the same band:
	\[
	e^{\varphi(z)} \sim e^{c_0} \left(1 + \frac{c_1}{z} + \dots\right)
	\]
\end{lemma}

\begin{lemma}{}\label{jungen_lemma_3}
	Let $\varphi(z)$ be analytic and expandable in the form \eqref{asymptotic_expansion_form} over a band \eqref{band_form}, we also have
	\[
	\varphi'(z) \sim -\frac{c_1}{z^2} - \frac{2c_2}{z^2} - \dots
	\]
	over any tighter band
	\begin{equation}
	\begin{cases}
	\Re(z) > a\\
	\Im(z) \in ]-b + \varepsilon, b + \varepsilon[
	\end{cases}
	\end{equation}
\end{lemma}

\begin{lemma}{}\label{lemma_quotient_gamma}
	Let $i$ an integer, $n$ a natural number and $s \in \mathbb{C} \setminus \{-1, -2, \dots\}$.
	
	Then there exists functions $\psi_{i, j}$ that can be expanded asymptotically, such that
	\begin{equation}
	\frac{\Gamma^{(i)}(n+s)}{\Gamma(n + 1)} = n^{s-1} [{(\log n)}^i \psi_{i, 0}(n) + \dots + \psi_{i, i}(n)]
	\end{equation}
\end{lemma}

\begin{proof}
	Start from Stirling's series for $\log \Gamma(z)$:
	\begin{align*}
	\log \Gamma(z) &\sim \psum{n=1}^\infty \frac{B_{2n}}{2n(2n-1)z^{2n-1}}\\
	&\sim \frac{1}{2} \log(2\pi) + \left(z + \frac{1}{2}\right) \log (z) - z + \frac{1}{12z} - \frac{1}{360z^2} + \dots
	\end{align*}
	where $B_n$ is the $n$-th Bernoulli number.
	
	Then by lemma \ref{jungen_lemma_2}
	\[
	\Gamma(z) = {\left(\frac{z}{e}\right)}^z \cdot z^{-1/2} \cdot \varphi(z)
	\]
	where $\varphi(z)$ can be expanded in asymptotic series over any half-band of type \eqref{band_form}.
	
	Now, differentiating $i$ times, we get
	\begin{equation*}
	\Gamma^{(i)}(z) = {\left(\frac{z}{e}\right)}^z z^{-1/2}
	\left[{(\log z)}^i \varphi_{i,0}(z) + \dots + \varphi_{i,i}(z) \right]
	\end{equation*}
	where the functions $\varphi_{i,j}$ can be expanded into asymptotic series, by lemmas \ref{jungen_lemma_1} and \ref{jungen_lemma_3}.
	
	Therefore,
	\begin{equation*}
	\frac{\Gamma^{(i)}(n+s)}{\Gamma(n + 1)} =
	{\left(\frac{n}{e}\right)}^{s - 1} \frac{{\left(1 + \frac{s}{n}\right)}^{n + s - 1/2}}{{\left(1 + \frac{1}{n}\right)}^{n + 1/2}}
	\cdot \frac{{(\log(n + s))}^i \varphi_{i,0}(n+s) + \dots + \varphi_{i,i}(n+s)}{\varphi(n + 1)}
	\end{equation*}
	and we may finally define the functions $\psi_{i, j}$ such that
	\[
	\frac{\Gamma^{(i)}(n+s)}{\Gamma(n + 1)} = n^{s-1} [{(\log n)}^i \psi_{i, 0}(n) + \dots + \psi_{i, i}(n)]
	\]
\end{proof}

\begin{thm}{Expansion theorem in the $\log$ case}\label{thm_expansion_log}
	Let $a \in \mathbb{C}$ and $k \in \mathbb{N}^*$.
	
	Let
	\[
	f : z \mapsto {(1 - z)}^{a} {\left( \log \frac{1}{1 - z} \right)}^k
	\]
	then for large $n$ one has
	\begin{align*}
	f_n =
	\begin{cases}
	\frac{n^{-a-1}}{\Gamma(-a)} \psum{i = 0}^k {(\log n)}^i \phi_i(n) &\text{ if $a \not\in \mathbb{N}$}\\
	{(-1)}^a k \Gamma(1 + a) n^{-a - 1} \psum{i = 0}^k {(\log n)}^i \phi_i(n) &\text{ if $a \in \mathbb{N}$}
	\end{cases}
	\end{align*}
	where the functions $\phi_i$ admit asymptotic expansions of the form
	\[
	\phi_i \sim c_{i, 0} + \frac{c_{i, 1}}{n} + \frac{c_{i, 2}}{n^2} + \dots
	\]
	and the constants $c_{i, j}$ can be explicitly computed.
\end{thm}

\begin{proof}
	Assume $a \not\in \mathbb{N}$. We can define
	$$\phi_0 : z \mapsto \Gamma(-a) {(1 - z)}^{-a}
	= \psum{n = 0}^\infty \frac{\Gamma(n - a)}{n!} z^n$$
	
	By differentiating $i$ times with respect to $a$, we get $\frac{d^i}{da} \Gamma(-a) = {(-1)}^i \Gamma^{(i)}(-a)$, and
	$\frac{d^i}{da} {(1 - z)}^{-a}
	= \frac{d^i}{da} e^{-a \log(1-z)}
	= \frac{d^i}{da} e^{a \left(\log \frac{1}{1-z}\right)}
	={\left(\log \frac{1}{1-z}\right)}^i {(1 - z)}^{-a}$
	so by Leibniz' rule:
	
	\begin{equation*}
	\phi_i := \frac{d^i}{da^i} \phi_0 =
	{(1 - z)}^{-a} \psum{j = 0}^i {i \choose j} {(-1)}^j \Gamma^{(j)}(-a) {\left(\log \frac{1}{1-z}\right)}^{i-j}
	\end{equation*}
	
	Now, when $i$ takes successively the values $0, \dots, k$, we get a triangular system of linear equations of unknowns the functions ${(1-z)}^{a} {\left(\log \frac{1}{1-z}\right)}^i$, the solution of which has the form
	\begin{equation}\label{general_scale_devt}
	{(1-z)}^{a} {\left(\log \frac{1}{1-z}\right)}^k
	= \frac{1}{\Gamma(-a)} \left[ \phi_k(z) + d_{k, k - 1} \phi_{k-1}(z) + \dots + d_{k, 0} \phi_0(z) \right]
	\end{equation}
	where the coefficients $d_{i, j}$ are explicitly computable and only depend on $i$ and $j$.
	
	Now, by definition of the $\phi_i$s, we have for all $i$
	\[
	\phi_i(z) = {(-1)}^i \psum{n = 0}^\infty \frac{\Gamma^{(i)}(n - a)}{n!} z^n
	\]
	
	By expanding equation \eqref{general_scale_devt} into Taylor series, this leads to the following equality
	\[
	f_n = \frac{1}{n! \Gamma(-a)} \left[
	\Gamma^{(k)}(n - a) + d_{k, k-1} \Gamma^{(k-1)}(n - a)
	+ \dots + d_{k, 0} \Gamma(n - a)
	\right]
	\]
	
	We now use lemma \ref{lemma_quotient_gamma} to conclude (recall that $n! = \Gamma(n + 1)$).
	
	\begin{center}
		***
	\end{center}
	
	To deal with the case $a \in \mathbb{N}$, use the relation
	\begin{align*}
	{(1 - z)}^a {\left(\log \frac{1}{1 - z}\right)}^k
	= &-a \int {(1 - z)}^{a - 1} {\left(\log \frac{1}{1 - z}\right)}^k\\
	&+ k \int {(1 - z)}^{a - 1} {\left(\log \frac{1}{1 - z}\right)}^{k - 1}
	\end{align*}
	$a + 1$ times to reduce to the first case.
\end{proof}

%\psum{j = 0}^\infty \frac{F_j(\log n)}{n^k}
%with $deg(F_j) \leq k-1$

%\paragraph{majoration pour les termes supplémentaires}
%Again by Cauchy's formula,
%\[
%f_n = \frac{1}{2i\pi} \int_{C} \frac{f(z)}{z^{n+1}} dz
%\]
%therefore
%\begin{align*}
%|f_n|	&\leq \left| \frac{1}{2i\pi} \int_{C} \frac{f(z)}{z^{n+1}} \right| dz\\
%		&\leq \frac{1}{2\pi} \int_{C} \left| \frac{f(z)}{z^{n+1}} \right| dz\\
%		&\leq \frac{1}{2\pi} \int_{C}
%\end{align*}


\end{document}